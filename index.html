<t t-name="website.tshirts">
    <t t-call="website.layout">
        <div id="wrap" class="oe_structure oe_empty"><section class="s_embed_code o_colored_level pt0 pb0 text-center" data-snippet="s_embed_code" data-name="Embed Code">
        <template class="s_embed_code_saved"><meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Custom Shirt Upload &amp; Download</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Lobster&amp;family=Montserrat:wght@400;700&amp;family=Pacifico&amp;family=Raleway:wght@400;700&amp;family=Open+Sans:wght@400;700&amp;family=Quicksand:wght@400;700&amp;family=Bangers&amp;family=Sacramento&amp;family=Indie+Flower&amp;family=Amatic+SC:wght@700&amp;family=Permanent+Marker&amp;family=Shadows+Into+Light&amp;family=Great+Vibes&amp;family=Press+Start+2P&amp;family=Fredericka+the+Great&amp;family=Rock+Salt&amp;family=Creepster&amp;family=Comic+Neue&amp;family=Gloria+Hallelujah&amp;family=Righteous&amp;family=Luckiest+Guy&amp;family=Black+Ops+One&amp;family=Boogaloo&amp;family=VT323&amp;display=swap" rel="stylesheet"/>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            margin: 0;
            overflow: auto;
        }

        .container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto;
        }

        .shirt-preview {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 500px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            user-select: none;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .shirt-template {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .uploadedImage {
            position: absolute;
            top: 50%;
            left: 50%;
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            transform: translate(-50%, -50%);
            opacity: 0.9;
            cursor: move;
            transition: transform 0.1s ease;
        }

        .controls {
            display: flex;
            flex-direction: column;
            max-width: 300px;
            flex: 1;
            margin-left: 20px;
        }

        input[type="file"] {
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;
        }

        .slider-label {
            font-size: 14px;
            margin-right: 10px;
        }

        .slider {
            width: 100%;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 10px;
        }

        #remove-btn {
            background-color: #dc3545;
        }

        #text-input {
            padding: 10px;
            font-size: 16px;
            margin-bottom: 10px;
        }

        #font-style-dropdown {
            margin-top: 10px;
            font-size: 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .draggable-text {
            position: absolute;
            cursor: move;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .controls {
                margin-left: 0;
                width: 100%;
                max-width: none;
            }

            .shirt-preview {
                max-width: 100%;
            }

            input[type="file"],
            .slider,
            button {
                font-size: 14px;
                padding: 8px;
            }
        }

        /* Button styles for front and back */
        .side-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }

        .side-buttons button {
            margin: 0 5px;
            background-color: #007bff;
        }
    </style>





    <h1>Upload and Customize Your Design</h1>

    
    <div class="side-buttons">
        <button onclick="showFront()">Front</button>
        <button onclick="showBack()">Back</button>
    </div>

    <div class="container">
        <div class="shirt-preview" id="shirtPreview">
            <img src="https://craftmyprints.odoo.com/web/image/864-a414b308/dae0ffb6-8eee-406c-86b4-874899f37843-removebg-preview.webp" alt="Shirt Template" class="shirt-template" id="shirtTemplate" loading="lazy"/>
        </div>

        <div class="controls">
            <input type="file" accept="image/*" onchange="previewImage(event)" id="imageInput"/>

            <div>
                <label for="sizeControl" class="slider-label">Resize Image:</label>
                <input type="range" id="sizeControl" class="slider" min="50" max="300" value="200" onchange="resizeImage()"/>
            </div>

            <div>
                <label for="rotateImageControl" class="slider-label">Rotate Image:</label>
                <input type="range" id="rotateImageControl" class="slider" min="0" max="360" value="0" onchange="rotateImage()"/>
            </div>

            <div>
                <label for="rotateTextControl" class="slider-label">Rotate Text:</label>
                <input type="range" id="rotateTextControl" class="slider" min="0" max="360" value="0" onchange="rotateText()"/>
            </div>

            <button id="remove-btn" onclick="removeImage()">Remove Image</button>

            <input type="text" id="text-input" placeholder="Enter text here" oninput="updateText()"/>
            
            <button id="remove-text-btn" onclick="removeText()">Remove Text</button>

            <select id="font-style-dropdown" onchange="selectFont(this.value)">
                <option value="Lobster" style="font-family: 'Lobster';">Lobster</option>
                
            </select>

            <div>
                <label for="textSizeControl" class="slider-label">Text Size:</label>
                <input type="range" id="textSizeControl" class="slider" min="10" max="110" value="32" onchange="updateText()"/>
            </div>

            <input type="color" id="text-color" value="#000000" onchange="changeTextColor()"/>

            <button id="download-btn" onclick="downloadFinalImage()">Download Final Image</button>
        </div>
    </div>

    <canvas id="finalCanvas" width="300" height="400" style="display: none;"/>

    <script>
        const canvas = document.getElementById('finalCanvas');
        const ctx = canvas.getContext('2d');
        const shirtPreview = document.getElementById('shirtPreview');
        let imgX = 50;
        let imgY = 50;
        let imgWidth = 200;
        let imgRotation = 0;
        let scale = 1;

        let isDraggingText = false;
        let startTextX, startTextY;

        let isDraggingImage = false;
        let startImageX, startImageY;

        let uploadedImages = [];
        let selectedImage = null; // Keeps track of the selected image for resizing and rotating
        let imageCount = 0;

        // Separate text properties for front and back designs
        const frontShirtImage = "https://craftmyprints.odoo.com/web/image/864-a414b308/dae0ffb6-8eee-406c-86b4-874899f37843-removebg-preview.webp";
        const backShirtImage = "https://craftmyprints.odoo.com/web/image/866-cbd77099/d48108e1-91d7-47f9-867b-52ffc8a8eaf5-removebg-preview.webp";

        let frontDesign = {
            images: [],
            text: "",
            fontSize: 32,
            fontFamily: "Lobster",
            color: "#000000",
            textX: 50,
            textY: 350,
            textRotation: 0
        };

        let backDesign = {
            images: [],
            text: "",
            fontSize: 32,
            fontFamily: "Lobster",
            color: "#000000",
            textX: 50,
            textY: 350,
            textRotation: 0
        };

        let currentDesign = frontDesign;

        function previewImage(event) {
            const imageInput = document.getElementById('imageInput');
            
            // Check if an image has already been uploaded
            if (uploadedImages.length &gt; 0) {
                alert('You can only upload one image.');
                return;
            }

            const files = event.target.files;
            if (files.length &gt; 0) {
                const reader = new FileReader();

                reader.onload = function () {
                    const imgElement = document.createElement('img');
                    imgElement.src = reader.result;
                    imgElement.classList.add('uploadedImage');
                    imgElement.style.transform = 'translate(0px, 0px)'; // Initial position
                    shirtPreview.appendChild(imgElement);

                    initImageDrag(imgElement); // Initialize dragging for the image

                    uploadedImages.push(imgElement); // Only one image will be added
                    currentDesign.images.push(imgElement); // Save the design to the current side
                };

                reader.readAsDataURL(files[0]);
            }

            // Disable the input field to prevent further uploads
            imageInput.disabled = true;
        }

        function initImageDrag(image) {
            // Initialize the image's position if it doesn't already have it
            if (!image.imgX) image.imgX = 0;
            if (!image.imgY) image.imgY = 0;

            // Support both mouse and touch events for dragging
            function startDrag(event) {
                isDraggingImage = true;
                selectedImage = image; // Make the clicked image the active one
                const evt = event.touches ? event.touches[0] : event;
                startImageX = evt.clientX - image.imgX; // Use image-specific position
                startImageY = evt.clientY - image.imgY; // Use image-specific position
                image.style.cursor = 'grabbing';
                event.preventDefault(); // Prevent screen movement
            }

            function moveDrag(event) {
                if (isDraggingImage &amp;&amp; selectedImage === image) { // Move only the selected image
                    const evt = event.touches ? event.touches[0] : event;
                    image.imgX = evt.clientX - startImageX;
                    image.imgY = evt.clientY - startImageY;
                    image.style.transform = `translate(${image.imgX}px, ${image.imgY}px) rotate(${imgRotation}deg)`; // Apply the image-specific position
                    event.preventDefault(); // Prevent screen movement
                }
            }

            function endDrag() {
                isDraggingImage = false;
                image.style.cursor = 'move';
            }

            image.onmousedown = startDrag;
            image.ontouchstart = startDrag;
            document.onmousemove = moveDrag;
            document.ontouchmove = moveDrag;
            document.onmouseup = endDrag;
            document.ontouchend = endDrag;
        }

        function resizeImage() {
            if (selectedImage) {
                const sizeControl = document.getElementById('sizeControl');
                const size = sizeControl.value;
                imgWidth = size;
                selectedImage.style.width = imgWidth + 'px';
                selectedImage.style.height = imgWidth + 'px'; // Maintain aspect ratio
            }
        }

        function rotateImage() {
            if (selectedImage) {
                const rotateControl = document.getElementById('rotateImageControl');
                imgRotation = rotateControl.value;
                selectedImage.style.transform = `translate(${imgX}px, ${imgY}px) rotate(${imgRotation}deg)`;
            }
        }

        function clearDesign() {
            // Clear existing images and text when switching sides
            shirtPreview.querySelectorAll('.uploadedImage').forEach(img =&gt; img.remove());
            shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
            uploadedImages = [];
            selectedImage = null;
        }

        function showFront() {
            clearDesign();
            currentDesign = frontDesign;
            document.getElementById('shirtTemplate').src = frontShirtImage; // Display the front shirt image
            loadDesign(currentDesign);
        }

        function showBack() {
            clearDesign();
            currentDesign = backDesign;
            document.getElementById('shirtTemplate').src = backShirtImage; // Display the back shirt image
            loadDesign(currentDesign);
        }

        function loadDesign(design) {
            // Load images
            design.images.forEach(img =&gt; {
                shirtPreview.appendChild(img);
                uploadedImages.push(img); // Track uploaded images
            });

            // Load text
            const textInput = document.getElementById('text-input');
            textInput.value = design.text;
            document.getElementById('textSizeControl').value = design.fontSize;
            document.getElementById('font-style-dropdown').value = design.fontFamily;
            document.getElementById('text-color').value = design.color;

            updateText();
        }

        function removeImage() {
            uploadedImages.forEach(img =&gt; img.remove());
            uploadedImages = [];
            currentDesign.images = [];
            document.getElementById('imageInput').disabled = false; // Re-enable image input
        }

        // Remove the text when the button is clicked
        function removeText() {
            const textDiv = shirtPreview.querySelector('.draggable-text');
            if (textDiv) {
                textDiv.remove(); // Remove the text from the preview
            }
            document.getElementById('text-input').value = ''; // Clear the text input
            currentDesign.text = ''; // Clear the text in the current design
        }

        function updateText() {
            const textInput = document.getElementById('text-input');
            const textSizeControl = document.getElementById('textSizeControl');
            const textSize = textSizeControl.value;

            // Clear existing text when input is empty
            if (textInput.value.trim() === "") {
                shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
                currentDesign.text = ""; // Clear the current design's text
                return; // Exit the function when input is empty
            }

            // Create and style text
            const textDiv = document.createElement('div');
            textDiv.classList.add('draggable-text');
            textDiv.style.position = 'absolute';
            textDiv.style.left = currentDesign.textX + 'px';
            textDiv.style.top = currentDesign.textY + 'px';
            textDiv.style.fontSize = textSize + 'px';
            textDiv.style.color = textColor;
            textDiv.style.fontFamily = document.getElementById('font-style-dropdown').value;
            textDiv.style.transform = `rotate(${currentDesign.textRotation}deg)`;
            textDiv.textContent = textInput.value;

            // Clear existing text
            shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
            shirtPreview.appendChild(textDiv);
            initTextDrag(textDiv);

            // Update the design on the current side
            currentDesign.text = textInput.value;
            currentDesign.fontSize = textSize;
            currentDesign.fontFamily = document.getElementById('font-style-dropdown').value;
            currentDesign.color = textColor;
        }

        function initTextDrag(textDiv) {
            // Support both mouse and touch events for dragging text
            function startDrag(event) {
                isDraggingText = true;
                const evt = event.touches ? event.touches[0] : event;
                startTextX = evt.clientX - currentDesign.textX;
                startTextY = evt.clientY - currentDesign.textY;
                textDiv.style.cursor = 'grabbing';
                event.preventDefault(); // Prevent screen movement
            }

            function moveDrag(event) {
                if (isDraggingText) {
                    const evt = event.touches ? event.touches[0] : event;
                    currentDesign.textX = evt.clientX - startTextX;
                    currentDesign.textY = evt.clientY - startTextY;
                    textDiv.style.left = currentDesign.textX + 'px';
                    textDiv.style.top = currentDesign.textY + 'px';

                    event.preventDefault(); // Prevent screen movement
                }
            }

            function endDrag() {
                isDraggingText = false;
                textDiv.style.cursor = 'move';
            }

            textDiv.onmousedown = startDrag;
            textDiv.ontouchstart = startDrag;
            document.onmousemove = moveDrag;
            document.ontouchmove = moveDrag;
            document.onmouseup = endDrag;
            document.ontouchend = endDrag;
        }

        function selectFont(font) {
            updateText();
        }

        let textColor = '#000000'; // Default text color set to black

function changeTextColor() {
    const textColorInput = document.getElementById('text-color');
    textColor = textColorInput.value;
    updateText();
}

function updateText() {
    const textInput = document.getElementById('text-input');
    const textSizeControl = document.getElementById('textSizeControl');
    const textSize = textSizeControl.value;

    // Clear existing text when input is empty
    if (textInput.value.trim() === "") {
        shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
        currentDesign.text = ""; // Clear the current design's text
        return; // Exit the function when input is empty
    }

    // Create and style text
    const textDiv = document.createElement('div');
    textDiv.classList.add('draggable-text');
    textDiv.style.position = 'absolute';
    textDiv.style.left = currentDesign.textX + 'px';
    textDiv.style.top = currentDesign.textY + 'px';
    textDiv.style.fontSize = textSize + 'px';
    textDiv.style.color = textColor; // Use the updated textColor value
    textDiv.style.fontFamily = document.getElementById('font-style-dropdown').value;
    textDiv.style.transform = `rotate(${currentDesign.textRotation}deg)`;
    textDiv.textContent = textInput.value;

    // Clear existing text
    shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
    shirtPreview.appendChild(textDiv);
    initTextDrag(textDiv);

    // Update the design on the current side
    currentDesign.text = textInput.value;
    currentDesign.fontSize = textSize;
    currentDesign.fontFamily = document.getElementById('font-style-dropdown').value;
    currentDesign.color = textColor; // Save the color in the current design
}

        function rotateText() {
            const rotateTextControl = document.getElementById('rotateTextControl');
            currentDesign.textRotation = rotateTextControl.value;
            updateText();
        }

        function downloadFinalImage() {
            const shirtTemplate = document.getElementById('shirtTemplate'); // Get the shirt template (current side)
            const canvasWidth = shirtPreview.offsetWidth;
            const canvasHeight = shirtPreview.offsetHeight;

            // Set the canvas size to match the shirt preview area
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;

            // Clear the canvas for new rendering
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw the shirt template (front or back)
            ctx.drawImage(shirtTemplate, 0, 0, canvasWidth, canvasHeight);

            // Draw all uploaded images
            uploadedImages.forEach((img) =&gt; {
                const imgPos = img.getBoundingClientRect();
                const previewPos = shirtPreview.getBoundingClientRect();

                // Calculate the position relative to the shirt preview
                const offsetX = imgPos.left - previewPos.left;
                const offsetY = imgPos.top - previewPos.top;
                const imgWidth = img.offsetWidth;
                const imgHeight = img.offsetHeight;

                // Draw each image onto the canvas
                ctx.drawImage(img, offsetX, offsetY, imgWidth, imgHeight);
            });

            // Draw the text
            shirtPreview.querySelectorAll('.draggable-text').forEach(textDiv =&gt; {
                const textStyle = window.getComputedStyle(textDiv);

                const fontSize = parseInt(textStyle.fontSize);
                const fontFamily = textStyle.fontFamily;
                const color = textStyle.color;

                // Set the font and color for text rendering
                ctx.font = `${fontSize}px ${fontFamily}`;
                ctx.fillStyle = color;

                // Calculate the text position relative to the shirt preview
                const textX = textDiv.offsetLeft;
                const textY = textDiv.offsetTop + fontSize;

                // Draw the text onto the canvas
                ctx.fillText(textDiv.textContent, textX, textY);
            });

            // Create a download link for the final image
            const link = document.createElement('a');
            link.download = 'custom_shirt_design.png';
            link.href = canvas.toDataURL();
            link.click();
        }
    </script></template>
        <div class="s_embed_code_embedded o_not_editable container"><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Custom Shirt Upload &amp;amp; Download</title><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;family=Lobster&amp;family=Montserrat:wght@400;700&amp;family=Pacifico&amp;family=Raleway:wght@400;700&amp;family=Open+Sans:wght@400;700&amp;family=Quicksand:wght@400;700&amp;family=Bangers&amp;family=Sacramento&amp;family=Indie+Flower&amp;family=Amatic+SC:wght@700&amp;family=Permanent+Marker&amp;family=Shadows+Into+Light&amp;family=Great+Vibes&amp;family=Press+Start+2P&amp;family=Fredericka+the+Great&amp;family=Rock+Salt&amp;family=Creepster&amp;family=Comic+Neue&amp;family=Gloria+Hallelujah&amp;family=Righteous&amp;family=Luckiest+Guy&amp;family=Black+Ops+One&amp;family=Boogaloo&amp;family=VT323&amp;display=swap" rel="stylesheet"/><style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            margin: 0;
            overflow: auto;
        }

        .container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto;
        }

        .shirt-preview {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 500px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            user-select: none;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .shirt-template {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .uploadedImage {
            position: absolute;
            top: 50%;
            left: 50%;
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            transform: translate(-50%, -50%);
            opacity: 0.9;
            cursor: move;
            transition: transform 0.1s ease;
        }

        .controls {
            display: flex;
            flex-direction: column;
            max-width: 300px;
            flex: 1;
            margin-left: 20px;
        }

        input[type="file"] {
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;
        }

        .slider-label {
            font-size: 14px;
            margin-right: 10px;
        }

        .slider {
            width: 100%;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 10px;
        }

        #remove-btn {
            background-color: #dc3545;
        }

        #text-input {
            padding: 10px;
            font-size: 16px;
            margin-bottom: 10px;
        }

        #font-style-dropdown {
            margin-top: 10px;
            font-size: 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .draggable-text {
            position: absolute;
            cursor: move;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .controls {
                margin-left: 0;
                width: 100%;
                max-width: none;
            }

            .shirt-preview {
                max-width: 100%;
            }

            input[type="file"],
            .slider,
            button {
                font-size: 14px;
                padding: 8px;
            }
        }

        /* Button styles for front and back */
        .side-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }

        .side-buttons button {
            margin: 0 5px;
            background-color: #007bff;
        }
    </style><h1>Upload and Customize Your Design</h1><div class="side-buttons">
        <button onclick="showFront()">Front</button>
        <button onclick="showBack()">Back</button>
    </div><div class="container">
        <div class="shirt-preview" id="shirtPreview">
            <img src="https://craftmyprints.odoo.com/web/image/864-a414b308/dae0ffb6-8eee-406c-86b4-874899f37843-removebg-preview.webp" alt="Shirt Template" class="shirt-template" id="shirtTemplate" loading="lazy"/>
        </div>

        <div class="controls">
            <input type="file" accept="image/*" onchange="previewImage(event)" id="imageInput"/>

            <div>
                <label for="sizeControl" class="slider-label">Resize Image:</label>
                <input type="range" id="sizeControl" class="slider" min="50" max="300" value="200" onchange="resizeImage()"/>
            </div>

            <div>
                <label for="rotateImageControl" class="slider-label">Rotate Image:</label>
                <input type="range" id="rotateImageControl" class="slider" min="0" max="360" value="0" onchange="rotateImage()"/>
            </div>

            <div>
                <label for="rotateTextControl" class="slider-label">Rotate Text:</label>
                <input type="range" id="rotateTextControl" class="slider" min="0" max="360" value="0" onchange="rotateText()"/>
            </div>

            <button id="remove-btn" onclick="removeImage()">Remove Image</button>

            <input type="text" id="text-input" placeholder="Enter text here" oninput="updateText()"/>
            
            <button id="remove-text-btn" onclick="removeText()">Remove Text</button>

            <select id="font-style-dropdown" onchange="selectFont(this.value)">
                <option value="Lobster" style="font-family: 'Lobster';">Lobster</option>
                
            </select>

            <div>
                <label for="textSizeControl" class="slider-label">Text Size:</label>
                <input type="range" id="textSizeControl" class="slider" min="10" max="110" value="32" onchange="updateText()"/>
            </div>

            <input type="color" id="text-color" value="#000000" onchange="changeTextColor()"/>

            <button id="download-btn" onclick="downloadFinalImage()">Download Final Image</button>
        </div>
    </div><canvas id="finalCanvas" width="300" height="400" style="display: none;"/><script>
        const canvas = document.getElementById('finalCanvas');
        const ctx = canvas.getContext('2d');
        const shirtPreview = document.getElementById('shirtPreview');
        let imgX = 50;
        let imgY = 50;
        let imgWidth = 200;
        let imgRotation = 0;
        let scale = 1;

        let isDraggingText = false;
        let startTextX, startTextY;

        let isDraggingImage = false;
        let startImageX, startImageY;

        let uploadedImages = [];
        let selectedImage = null; // Keeps track of the selected image for resizing and rotating
        let imageCount = 0;

        // Separate text properties for front and back designs
        const frontShirtImage = "https://craftmyprints.odoo.com/web/image/864-a414b308/dae0ffb6-8eee-406c-86b4-874899f37843-removebg-preview.webp";
        const backShirtImage = "https://craftmyprints.odoo.com/web/image/866-cbd77099/d48108e1-91d7-47f9-867b-52ffc8a8eaf5-removebg-preview.webp";

        let frontDesign = {
            images: [],
            text: "",
            fontSize: 32,
            fontFamily: "Lobster",
            color: "#000000",
            textX: 50,
            textY: 350,
            textRotation: 0
        };

        let backDesign = {
            images: [],
            text: "",
            fontSize: 32,
            fontFamily: "Lobster",
            color: "#000000",
            textX: 50,
            textY: 350,
            textRotation: 0
        };

        let currentDesign = frontDesign;

        function previewImage(event) {
            const imageInput = document.getElementById('imageInput');
            
            // Check if an image has already been uploaded
            if (uploadedImages.length &gt; 0) {
                alert('You can only upload one image.');
                return;
            }

            const files = event.target.files;
            if (files.length &gt; 0) {
                const reader = new FileReader();

                reader.onload = function () {
                    const imgElement = document.createElement('img');
                    imgElement.src = reader.result;
                    imgElement.classList.add('uploadedImage');
                    imgElement.style.transform = 'translate(0px, 0px)'; // Initial position
                    shirtPreview.appendChild(imgElement);

                    initImageDrag(imgElement); // Initialize dragging for the image

                    uploadedImages.push(imgElement); // Only one image will be added
                    currentDesign.images.push(imgElement); // Save the design to the current side
                };

                reader.readAsDataURL(files[0]);
            }

            // Disable the input field to prevent further uploads
            imageInput.disabled = true;
        }

        function initImageDrag(image) {
            // Initialize the image's position if it doesn't already have it
            if (!image.imgX) image.imgX = 0;
            if (!image.imgY) image.imgY = 0;

            // Support both mouse and touch events for dragging
            function startDrag(event) {
                isDraggingImage = true;
                selectedImage = image; // Make the clicked image the active one
                const evt = event.touches ? event.touches[0] : event;
                startImageX = evt.clientX - image.imgX; // Use image-specific position
                startImageY = evt.clientY - image.imgY; // Use image-specific position
                image.style.cursor = 'grabbing';
                event.preventDefault(); // Prevent screen movement
            }

            function moveDrag(event) {
                if (isDraggingImage &amp;&amp; selectedImage === image) { // Move only the selected image
                    const evt = event.touches ? event.touches[0] : event;
                    image.imgX = evt.clientX - startImageX;
                    image.imgY = evt.clientY - startImageY;
                    image.style.transform = `translate(${image.imgX}px, ${image.imgY}px) rotate(${imgRotation}deg)`; // Apply the image-specific position
                    event.preventDefault(); // Prevent screen movement
                }
            }

            function endDrag() {
                isDraggingImage = false;
                image.style.cursor = 'move';
            }

            image.onmousedown = startDrag;
            image.ontouchstart = startDrag;
            document.onmousemove = moveDrag;
            document.ontouchmove = moveDrag;
            document.onmouseup = endDrag;
            document.ontouchend = endDrag;
        }

        function resizeImage() {
            if (selectedImage) {
                const sizeControl = document.getElementById('sizeControl');
                const size = sizeControl.value;
                imgWidth = size;
                selectedImage.style.width = imgWidth + 'px';
                selectedImage.style.height = imgWidth + 'px'; // Maintain aspect ratio
            }
        }

        function rotateImage() {
            if (selectedImage) {
                const rotateControl = document.getElementById('rotateImageControl');
                imgRotation = rotateControl.value;
                selectedImage.style.transform = `translate(${imgX}px, ${imgY}px) rotate(${imgRotation}deg)`;
            }
        }

        function clearDesign() {
            // Clear existing images and text when switching sides
            shirtPreview.querySelectorAll('.uploadedImage').forEach(img =&gt; img.remove());
            shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
            uploadedImages = [];
            selectedImage = null;
        }

        function showFront() {
            clearDesign();
            currentDesign = frontDesign;
            document.getElementById('shirtTemplate').src = frontShirtImage; // Display the front shirt image
            loadDesign(currentDesign);
        }

        function showBack() {
            clearDesign();
            currentDesign = backDesign;
            document.getElementById('shirtTemplate').src = backShirtImage; // Display the back shirt image
            loadDesign(currentDesign);
        }

        function loadDesign(design) {
            // Load images
            design.images.forEach(img =&gt; {
                shirtPreview.appendChild(img);
                uploadedImages.push(img); // Track uploaded images
            });

            // Load text
            const textInput = document.getElementById('text-input');
            textInput.value = design.text;
            document.getElementById('textSizeControl').value = design.fontSize;
            document.getElementById('font-style-dropdown').value = design.fontFamily;
            document.getElementById('text-color').value = design.color;

            updateText();
        }

        function removeImage() {
            uploadedImages.forEach(img =&gt; img.remove());
            uploadedImages = [];
            currentDesign.images = [];
            document.getElementById('imageInput').disabled = false; // Re-enable image input
        }

        // Remove the text when the button is clicked
        function removeText() {
            const textDiv = shirtPreview.querySelector('.draggable-text');
            if (textDiv) {
                textDiv.remove(); // Remove the text from the preview
            }
            document.getElementById('text-input').value = ''; // Clear the text input
            currentDesign.text = ''; // Clear the text in the current design
        }

        function updateText() {
            const textInput = document.getElementById('text-input');
            const textSizeControl = document.getElementById('textSizeControl');
            const textSize = textSizeControl.value;

            // Clear existing text when input is empty
            if (textInput.value.trim() === "") {
                shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
                currentDesign.text = ""; // Clear the current design's text
                return; // Exit the function when input is empty
            }

            // Create and style text
            const textDiv = document.createElement('div');
            textDiv.classList.add('draggable-text');
            textDiv.style.position = 'absolute';
            textDiv.style.left = currentDesign.textX + 'px';
            textDiv.style.top = currentDesign.textY + 'px';
            textDiv.style.fontSize = textSize + 'px';
            textDiv.style.color = textColor;
            textDiv.style.fontFamily = document.getElementById('font-style-dropdown').value;
            textDiv.style.transform = `rotate(${currentDesign.textRotation}deg)`;
            textDiv.textContent = textInput.value;

            // Clear existing text
            shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
            shirtPreview.appendChild(textDiv);
            initTextDrag(textDiv);

            // Update the design on the current side
            currentDesign.text = textInput.value;
            currentDesign.fontSize = textSize;
            currentDesign.fontFamily = document.getElementById('font-style-dropdown').value;
            currentDesign.color = textColor;
        }

        function initTextDrag(textDiv) {
            // Support both mouse and touch events for dragging text
            function startDrag(event) {
                isDraggingText = true;
                const evt = event.touches ? event.touches[0] : event;
                startTextX = evt.clientX - currentDesign.textX;
                startTextY = evt.clientY - currentDesign.textY;
                textDiv.style.cursor = 'grabbing';
                event.preventDefault(); // Prevent screen movement
            }

            function moveDrag(event) {
                if (isDraggingText) {
                    const evt = event.touches ? event.touches[0] : event;
                    currentDesign.textX = evt.clientX - startTextX;
                    currentDesign.textY = evt.clientY - startTextY;
                    textDiv.style.left = currentDesign.textX + 'px';
                    textDiv.style.top = currentDesign.textY + 'px';

                    event.preventDefault(); // Prevent screen movement
                }
            }

            function endDrag() {
                isDraggingText = false;
                textDiv.style.cursor = 'move';
            }

            textDiv.onmousedown = startDrag;
            textDiv.ontouchstart = startDrag;
            document.onmousemove = moveDrag;
            document.ontouchmove = moveDrag;
            document.onmouseup = endDrag;
            document.ontouchend = endDrag;
        }

        function selectFont(font) {
            updateText();
        }

        let textColor = '#000000'; // Default text color set to black

function changeTextColor() {
    const textColorInput = document.getElementById('text-color');
    textColor = textColorInput.value;
    updateText();
}

function updateText() {
    const textInput = document.getElementById('text-input');
    const textSizeControl = document.getElementById('textSizeControl');
    const textSize = textSizeControl.value;

    // Clear existing text when input is empty
    if (textInput.value.trim() === "") {
        shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
        currentDesign.text = ""; // Clear the current design's text
        return; // Exit the function when input is empty
    }

    // Create and style text
    const textDiv = document.createElement('div');
    textDiv.classList.add('draggable-text');
    textDiv.style.position = 'absolute';
    textDiv.style.left = currentDesign.textX + 'px';
    textDiv.style.top = currentDesign.textY + 'px';
    textDiv.style.fontSize = textSize + 'px';
    textDiv.style.color = textColor; // Use the updated textColor value
    textDiv.style.fontFamily = document.getElementById('font-style-dropdown').value;
    textDiv.style.transform = `rotate(${currentDesign.textRotation}deg)`;
    textDiv.textContent = textInput.value;

    // Clear existing text
    shirtPreview.querySelectorAll('.draggable-text').forEach(div =&gt; div.remove());
    shirtPreview.appendChild(textDiv);
    initTextDrag(textDiv);

    // Update the design on the current side
    currentDesign.text = textInput.value;
    currentDesign.fontSize = textSize;
    currentDesign.fontFamily = document.getElementById('font-style-dropdown').value;
    currentDesign.color = textColor; // Save the color in the current design
}

        function rotateText() {
            const rotateTextControl = document.getElementById('rotateTextControl');
            currentDesign.textRotation = rotateTextControl.value;
            updateText();
        }

        function downloadFinalImage() {
            const shirtTemplate = document.getElementById('shirtTemplate'); // Get the shirt template (current side)
            const canvasWidth = shirtPreview.offsetWidth;
            const canvasHeight = shirtPreview.offsetHeight;

            // Set the canvas size to match the shirt preview area
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;

            // Clear the canvas for new rendering
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw the shirt template (front or back)
            ctx.drawImage(shirtTemplate, 0, 0, canvasWidth, canvasHeight);

            // Draw all uploaded images
            uploadedImages.forEach((img) =&gt; {
                const imgPos = img.getBoundingClientRect();
                const previewPos = shirtPreview.getBoundingClientRect();

                // Calculate the position relative to the shirt preview
                const offsetX = imgPos.left - previewPos.left;
                const offsetY = imgPos.top - previewPos.top;
                const imgWidth = img.offsetWidth;
                const imgHeight = img.offsetHeight;

                // Draw each image onto the canvas
                ctx.drawImage(img, offsetX, offsetY, imgWidth, imgHeight);
            });

            // Draw the text
            shirtPreview.querySelectorAll('.draggable-text').forEach(textDiv =&gt; {
                const textStyle = window.getComputedStyle(textDiv);

                const fontSize = parseInt(textStyle.fontSize);
                const fontFamily = textStyle.fontFamily;
                const color = textStyle.color;

                // Set the font and color for text rendering
                ctx.font = `${fontSize}px ${fontFamily}`;
                ctx.fillStyle = color;

                // Calculate the text position relative to the shirt preview
                const textX = textDiv.offsetLeft;
                const textY = textDiv.offsetTop + fontSize;

                // Draw the text onto the canvas
                ctx.fillText(textDiv.textContent, textX, textY);
            });

            // Create a download link for the final image
            const link = document.createElement('a');
            link.download = 'custom_shirt_design.png';
            link.href = canvas.toDataURL();
            link.click();
        }
    </script></div>
    </section></div>
    </t>
</t>